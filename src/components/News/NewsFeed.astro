---
import { getCollection } from 'astro:content';
import NewsItem from './NewsItem.astro';
import './news-feed.css';

const { limit, title } = Astro.props;

const newsItems = (
  await getCollection("news")
).sort((a, b) => {
  let da = new Date(a.data.date);
  let db = new Date(b.data.date);
  return (db.valueOf() - da.valueOf());
});

if (limit && limit > 0) {
  newsItems.splice(limit);
}

---

<div class="news-feed-wrapper">
  <div id="news-feed">
    { title && (
      <h2>{title}</h2>
    )}
    <ul>
      {
        newsItems.map((item: any) => (
          <NewsItem item={item} />
        ))
      }
    </ul>
    { limit && (
      <a href="/news">
        View More News &rarr;
      </a>
    )}
  </div>
</div>
